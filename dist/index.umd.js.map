{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["import anime from \"animejs/lib/anime.es.js\";\nimport './index.scss';\n\nexport default class ImgPreview {\n  constructor(options) {\n    this.options = Object.assign(this.defaultOptions, options);\n  }\n\n  get defaultOptions() {\n    return {\n      containerID: 'img_preview-container',\n      distanceFromCursor: { top: 10, left: 10 }\n    };\n  }\n\n  get containerID() {\n    return this.options.containerID;\n  }\n\n  get containerClass() {\n    return 'img_preview-container';\n  }\n\n  get containerLoadingClass() {\n    return 'img_preview-container__loading';\n  }\n\n  init() {\n    let node = document.createElement('div');\n    node.setAttribute('id', this.containerID);\n    node.classList.add(this.containerClass);\n    node.append(document.createElement('img'));\n    node.style.display = 'none';\n    node.style.position = 'absolute';\n    document.querySelector('body').append(node);\n    this.container = document.querySelector(`#${this.containerID}`);\n    this.img = this.container.querySelector('img');\n  }\n\n  run(elems) {\n    let selectors = this.filterElements(elems);\n\n    let self = this;\n    function loadImage(e) {\n      self.container.classList.remove(self.containerLoadingClass);\n      self.img.style.display = '';\n      self.onLoad(self.img);\n      e.currentTarget.removeEventListener('load', this);\n    }\n\n    Array.prototype.forEach.call(selectors, (selector) => {\n      selector.addEventListener('mousemove', (e) => {\n        this.container.style.top = e.pageY + this.options.distanceFromCursor.top + 'px';\n        this.container.style.left = e.pageX + this.options.distanceFromCursor.left + 'px';\n      });\n\n      selector.addEventListener('mouseover', (e) => {\n        this.container.classList.add(this.containerLoadingClass);\n        this.container.style.display = '';\n        this.img.addEventListener('load', { handleEvent: loadImage });\n\n        this.img.setAttribute('src', this.extractUrl(e.currentTarget));\n        this.onShow(this.container, e.currentTarget);\n      });\n\n      selector.addEventListener('mouseout', (e) => {\n        this.container.style.display = 'none';\n        this.img.setAttribute('src','');\n        this.img.style.display = 'none';\n        this.onHide(e.currentTarget);\n      });\n    });\n  }\n\n  filterElements(elems) {\n    let regexp = new RegExp('.(gif|jpe?g|png|bmp|webp)$', 'i');\n    let arrayElems = [].map.call(elems, (elem) => { return elem; });\n    let collection = arrayElems.filter((elem, index) => {\n      let url = undefined;\n      try {\n        url = new URL(this.extractUrl(elem), window.location);\n      } catch(e) {}\n      return !! (url && url.pathname.match(regexp));\n    });\n\n    return collection;\n  }\n\n  extractUrl(elem) {\n    let url = undefined;\n\n    if (elem.tagName == 'A') {\n      url = elem.getAttribute('data-image');\n    } else if (elem.tagName == 'IMG') {\n      url = elem.getAttribute('src');\n    }\n\n    return url;\n  }\n\n  onShow(container, target) {\n    anime.remove(target);\n    anime({\n      targets: target,\n      opacity: 0.4,\n      duration: 400,\n      easing: 'linear'\n    });\n    anime.remove(container.querySelector('img'));\n    container.querySelector('img').style.opacity = 0;\n  }\n\n  onLoad(img) {\n    anime.remove(img);\n    anime({\n      targets: img,\n      opacity: 1,\n      duration: 300,\n      easing: 'linear'\n    });\n  }\n\n  onHide(target) {\n    anime.remove(target);\n    anime({\n      targets: target,\n      opacity: 1,\n      duration: 300,\n      easing: 'linear'\n    });\n  }\n}\n"],"names":["ImgPreview","constructor","options","this","Object","assign","defaultOptions","containerID","distanceFromCursor","top","left","containerLoadingClass","init","node","document","createElement","setAttribute","classList","add","containerClass","append","style","display","position","querySelector","container","img","run","elems","selectors","filterElements","self","loadImage","e","remove","onLoad","currentTarget","removeEventListener","Array","prototype","forEach","call","selector","addEventListener","pageY","pageX","handleEvent","extractUrl","onShow","onHide","regexp","RegExp","map","elem","filter","index","url","undefined","URL","window","location","pathname","match","tagName","getAttribute","target","anime","targets","opacity","duration","easing"],"mappings":"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"}